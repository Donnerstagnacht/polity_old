"use strict";(self.webpackChunkpolity=self.webpackChunkpolity||[]).push([[479],{5479:(Be,C,r)=>{r.r(C),r.d(C,{ProfileModule:()=>Re});var u=r(6895),Z=r(8783),U=r(7772),P=r(2665),g=r(8996),_=r(1740),b=r(5593),k=r(5047),m=r(433),A=r(3054),T=r(6919),y=r(8271),d=r(2453),z=r(8830),F=r(5480),J=r(989),K=r(7136),O=r(6609),e=r(4650);let V=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[u.ez,d.EV,g.Bz,Z.LU,z.U$,y.F,m.u5,m.UX,_.j,b.hJ,F.x,J.n,K.R,O.z]}),o})();var c=r(5861),p=r(805),D=r(9466),S=r(4143),w=r(5754),$=r(9488),h=r(6923),v=r(8092),M=r(9469),Q=r(9762),x=r(8249);function j(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"div",5)(1,"div",6),e._UZ(2,"app-back-button",7),e.TgZ(3,"div",8)(4,"app-tab-view-table-lists",9),e.NdJ("removeItemFromFirstTab",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.onRemoveFollower(n))})("removeItemFromSecontTab",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.onUnFollow(n))}),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("title","Zur\xfcck")("link","/profile/edit"),e.xp6(2),e.Q6J("dataFirstTab",t.followers)("dataSecondTab",t.followings)("titleFirstTab",t.titleFollower)("titleSecondTab",t.titleFollowings)("noDataFirstTab",t.noDataFollower)("noDataFirstTab",t.noDataFollowings)("paginationDataFirstTab",t.paginationDataFirstTab)("paginationDataSecondTab",t.paginationDataSecondTab)}}let q=(()=>{class o{constructor(t,i,n,a,s,I){this.followingService=t,this.messageService=i,this.profileQuery=n,this.profileService=a,this.followingGroupsService=s,this.authentificationQuery=I,this.columns=[],this.followers=[],this.followings=[],this.titleFollower="Follower",this.titleFollowings="Followings",this.noDataFollower="Du hast noch keine Follower.",this.noDataFollowings="Du folgst noch niemanden.",this.loggedInID="",this.filterString="",this.loadingInitial=!1,this.loadingFollower=!1,this.loadingFollowing=!1,this.error=!1,this.errorFollower=!1,this.errorFollowing=!1,this.paginationDataFirstTab={from:0,to:2,canLoad:!0,reloadDelay:2e3,sizeOfNewLoad:10,numberOfSearchResults:0},this.paginationDataSecondTab={from:0,to:2,canLoad:!0,reloadDelay:2e3,sizeOfNewLoad:10,numberOfSearchResults:0}}ngOnInit(){this.getProfileId(),this.loadInitialData()}ngOnDestroy(){this.profileFollowerRealtimeSubscription&&this.profileFollowerRealtimeSubscription.unsubscribe(),this.groupFollowerRealtimeSubscription&&this.groupFollowerRealtimeSubscription.unsubscribe(),this.authSubscription&&this.authSubscription.unsubscribe(),this.profileSubscription&&this.profileSubscription.unsubscribe()}loadInitialData(){var t=this;return(0,c.Z)(function*(){console.log("before getFollowingSystem"),t.getFollowingSystem();try{t.loadingInitial=!0,t.loadingFollower=!0,t.error=!1,t.loadingInitial=t.loadingFollower||t.loadingFollowing,yield t.profileService.getAllFollowers(t.loggedInID)}catch(i){t.errorFollower=!0,t.error=t.errorFollower||t.errorFollowing,t.errorMessage=i.message,t.messageService.add({severity:"error",summary:i.message})}finally{t.loadingFollower=!1,t.loadingInitial=t.loadingFollower||t.loadingFollowing}if(!t.errorFollower)try{t.loadingFollowing=!0,t.errorFollowing=!1,yield t.profileService.getAllFollowings(t.loggedInID)}catch(i){t.errorFollowing=!0,t.error=t.errorFollower||t.errorFollowing,t.errorMessage=i.message,t.messageService.add({severity:"error",summary:i.message})}finally{t.loadingFollowing=!1,t.loadingInitial=t.loadingFollower||t.loadingFollowing}t.profileFollowerRealtimeSubscription=t.profileService.getRealTimeChangesFollowerSystem(t.loggedInID),t.groupFollowerRealtimeSubscription=t.profileService.getRealTimeChangesGroupFollowerSystem(t.loggedInID)})()}getProfileId(){this.authSubscription=this.authentificationQuery.uuid$.subscribe(t=>{t&&(this.loggedInID=t)})}getFollowingSystem(){this.profileSubscription=this.profileQuery.selectEntity(this.loggedInID).subscribe(t=>{t?.followers&&(this.followers=[],this.followers=t.followers,this.paginationDataFirstTab.numberOfSearchResults=this.followers.length,console.log("followers"),console.log(this.followers)),t?.followings&&(this.followings=[],this.followings=t.followings,this.paginationDataSecondTab.numberOfSearchResults=this.followings.length,console.log("followings"),console.log(this.followings))})}onRemoveFollower(t){var i=this;return(0,c.Z)(function*(){if(!t.isGroup)try{yield i.followingService.removeFollowerTransactionById(t),i.messageService.add({severity:"success",summary:"Follower entfernt."})}catch(n){i.messageService.add({severity:"error",summary:n})}})()}onUnFollow(t){var i=this;return(0,c.Z)(function*(){const a=t.user_id;if(t.boolean)try{yield i.followingGroupsService.removeFollowerTransaction(i.loggedInID,a),i.messageService.add({severity:"success",summary:"Du folgst der Gruppe nicht mehr."})}catch(s){i.messageService.add({severity:"error",summary:s})}else try{yield i.followingService.unfollowTransaction(t.user_id),i.messageService.add({severity:"success",summary:"Du folgst der Person nicht mehr."})}catch(s){i.messageService.add({severity:"error",summary:s})}})()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(D.J),e.Y36(p.ez),e.Y36(S.w),e.Y36(w.H),e.Y36($.s),e.Y36(h.c))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-follower-management"]],features:[e._Bn([p.ez])],decls:5,vars:5,consts:[["styleClass","max-w-90","position","top-right"],[3,"noTopBar"],["slot","main"],[3,"error","loading","errorMessage","retryAction"],["class","mb-8",4,"ngIf"],[1,"mb-8"],[1,"mx-4"],["data-cy","backButton",3,"title","link"],[1,"mb-30"],[3,"dataFirstTab","dataSecondTab","titleFirstTab","titleSecondTab","noDataFirstTab","paginationDataFirstTab","paginationDataSecondTab","removeItemFromFirstTab","removeItemFromSecontTab"]],template:function(t,i){1&t&&(e._UZ(0,"p-toast",0),e.TgZ(1,"app-wrapper-grid",1)(2,"div",2)(3,"app-loading-spinner",3),e.NdJ("retryAction",function(){return i.loadInitialData()}),e.qZA(),e.YNc(4,j,5,10,"div",4),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("noTopBar",!0),e.xp6(2),e.Q6J("error",i.error)("loading",i.loadingInitial)("errorMessage",i.errorMessage),e.xp6(1),e.Q6J("ngIf",!i.loadingInitial&&!i.error))},dependencies:[u.O5,d.FN,v.V,M.W,Q.r,x.g],styles:["a[_ngcontent-%COMP%]{text-decoration:none;color:#000}"]}),o})();var X=r(9049),W=r(7427),ee=r(4576);function te(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"div",9)(1,"app-tab-view-table-lists",10),e.NdJ("removeItemFromFirstTab",function(n){e.CHM(t);const a=e.oxw(2);return e.KtG(a.leaveGroup(n))}),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("paginationDataFirstTab",t.paginationDataFirstTab)("dataFirstTab",t.groupsOfUser)("titleFirstTab",t.titleYourGroups)("noDataFirstTab",t.noGroups)("secondTabNeeded",!1)("acceptButtonNeededFirstTab",!1)}}function ie(o,l){if(1&o&&(e.TgZ(0,"div",5)(1,"div",6),e._UZ(2,"app-back-button",7),e.YNc(3,te,2,6,"div",8),e.qZA()()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("title","Zur\xfcck")("link",t.link),e.xp6(1),e.Q6J("ngIf",t.groupsOfUser)}}let oe=(()=>{class o{constructor(t,i,n,a,s,I,Ge){this.membershipService=t,this.authentificationQuery=i,this.messageService=n,this.groupsService=a,this.profileService=s,this.profileQuery=I,this.profileStore=Ge,this.selectedGroupId="",this.groupsOfUser=[],this.link="",this.titleYourGroups="Deine Gruppen",this.noGroups="Du bist in noch keiner Gruppe Mitglied.",this.loggedInID="",this.loadingInitial=!1,this.error=!1,this.paginationDataFirstTab={from:0,to:2,canLoad:!0,reloadDelay:2e3,sizeOfNewLoad:10,numberOfSearchResults:0}}ngOnInit(){this.link="/profile/edit",this.authSubscription=this.authentificationQuery.uuid$.subscribe(t=>{this.loggedInID=t}),this.loadInitialData(),this.loggedInID&&(this.profileSubscription=this.profileQuery.selectEntity(this.loggedInID).subscribe(t=>{t&&(this.groupsOfUser=t.groups)}),this.groupsRealtimeSubscription=this.profileService.getRealTimeChangesGroupsOfProfile(this.loggedInID))}ngOnDestroy(){this.groupsRealtimeSubscription&&this.groupsRealtimeSubscription.unsubscribe(),this.authSubscription&&this.authSubscription.unsubscribe(),this.profileSubscription&&this.profileSubscription.unsubscribe()}loadInitialData(){var t=this;return(0,c.Z)(function*(){try{t.loadingInitial=!0,t.error=!1,yield t.getAllGroups()}catch(i){t.error=!0,t.errorMessage=i.message,t.messageService.add({severity:"error",summary:i.message})}finally{t.loadingInitial=!1}})()}leaveGroup(t){var i=this;return(0,c.Z)(function*(){try{i.loggedInID&&(yield i.membershipService.removeMemberByMembershipId(t.id,i.loggedInID,t.user_id),i.messageService.add({severity:"success",summary:"Du bist aus einer Gruppe ausgetreten."}))}catch(n){i.messageService.add({severity:"error",summary:n.message})}})()}getAllGroups(){var t=this;return(0,c.Z)(function*(){console.log(1);const i=yield t.groupsService.getAllGroupsOfId();if(i.data){let n=[];console.log("groupList"),console.log(i),i.data.forEach(a=>{n.push({id:a.id,name:a.groups.name,avatar_url:a.groups.avatar_url,user_id:a.group_id,isGroup:!0})}),t.profileStore.upsert(t.loggedInID,{groups:n})}if(i.error)throw new Error(i.error.message)})()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(X.v),e.Y36(h.c),e.Y36(p.ez),e.Y36(W.J),e.Y36(w.H),e.Y36(S.w),e.Y36(ee.s))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-membership-user-management"]],features:[e._Bn([p.ez])],decls:5,vars:5,consts:[["styleClass","max-w-90","position","top-right"],[3,"noTopBar"],["slot","main"],[3,"error","loading","errorMessage","retryAction"],["class","mb-8",4,"ngIf"],[1,"mb-8"],[1,"mx-4"],["data-cy","backButton",3,"title","link"],["class","mb-30",4,"ngIf"],[1,"mb-30"],[3,"paginationDataFirstTab","dataFirstTab","titleFirstTab","noDataFirstTab","secondTabNeeded","acceptButtonNeededFirstTab","removeItemFromFirstTab"]],template:function(t,i){1&t&&(e._UZ(0,"p-toast",0),e.TgZ(1,"app-wrapper-grid",1)(2,"div",2)(3,"app-loading-spinner",3),e.NdJ("retryAction",function(){return i.loadInitialData()}),e.qZA(),e.YNc(4,ie,4,3,"div",4),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("noTopBar",!0),e.xp6(2),e.Q6J("error",i.error)("loading",i.loadingInitial)("errorMessage",i.errorMessage),e.xp6(1),e.Q6J("ngIf",!i.loadingInitial&&!i.error))},dependencies:[u.O5,d.FN,v.V,M.W,Q.r,x.g]}),o})();var f=r(9028),N=r(529),ne=r(9338);function re(o,l){if(1&o&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Oqu(t.profile.name)}}function ae(o,l){if(1&o&&e._UZ(0,"p-avatar",30),2&o){const t=e.oxw(2);e.Q6J("image",t.profile.avatar_url)}}function le(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"div",8)(1,"h5"),e._uU(2,"Pers\xf6nliche Daten"),e.qZA(),e.YNc(3,re,2,1,"p",9),e.TgZ(4,"div",10)(5,"div",11)(6,"span",12)(7,"input",13),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.profile.name=n)}),e.qZA(),e.TgZ(8,"label",14),e._uU(9,"Name"),e.qZA()()(),e.TgZ(10,"div",11)(11,"span",12)(12,"input",15),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.profile.website=n)}),e.qZA(),e.TgZ(13,"label",14),e._uU(14,"Website"),e.qZA()()(),e.TgZ(15,"div",16)(16,"span",12)(17,"textarea",17,18),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.profile.about=n)}),e.qZA(),e.TgZ(19,"label",14),e._uU(20,"\xdcber mich"),e.qZA()()()(),e.TgZ(21,"div")(22,"h5"),e._uU(23,"Profile Foto"),e.qZA(),e.YNc(24,ae,1,1,"p-avatar",19),e.TgZ(25,"p-fileUpload",20,21),e.NdJ("uploadHandler",function(n){e.CHM(t);const a=e.MAs(26),s=e.oxw();return e.KtG(s.updateProfilePhoto(n,a))}),e.qZA()(),e.TgZ(27,"h5"),e._uU(28,"Kontaktm\xf6glichkeiten"),e.qZA(),e.TgZ(29,"div",10)(30,"div",11)(31,"span",12)(32,"input",22),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.profile.contact_email=n)}),e.qZA(),e.TgZ(33,"label",14),e._uU(34,"Email"),e.qZA()()(),e.TgZ(35,"div",11)(36,"span",12)(37,"input",23),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.profile.contact_phone=n)}),e.qZA(),e.TgZ(38,"label",14),e._uU(39,"Phone"),e.qZA()()()(),e.TgZ(40,"h5"),e._uU(41,"Adresse"),e.qZA(),e.TgZ(42,"div",10)(43,"div",11)(44,"span",12)(45,"input",24),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.profile.street=n)}),e.qZA(),e.TgZ(46,"label",14),e._uU(47,"Street"),e.qZA()()(),e.TgZ(48,"div",11)(49,"span",12)(50,"input",25),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.profile.post_code=n)}),e.qZA(),e.TgZ(51,"label",14),e._uU(52,"Post Code"),e.qZA()()(),e.TgZ(53,"div",11)(54,"span",12)(55,"input",26),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.profile.city=n)}),e.qZA(),e.TgZ(56,"label",14),e._uU(57,"City"),e.qZA()()()(),e.TgZ(58,"div",27)(59,"div",28)(60,"button",29),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.updateContactInformation(n.profile))}),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",t.profile),e.xp6(4),e.Q6J("ngModel",t.profile.name),e.xp6(5),e.Q6J("ngModel",t.profile.website),e.xp6(5),e.Q6J("autoResize",!0)("ngModel",t.profile.about),e.xp6(7),e.Q6J("ngIf",t.profile.avatar_url),e.xp6(1),e.Q6J("auto",!0)("customUpload",!0),e.xp6(7),e.Q6J("ngModel",t.profile.contact_email),e.xp6(5),e.Q6J("ngModel",t.profile.contact_phone),e.xp6(8),e.Q6J("ngModel",t.profile.street),e.xp6(5),e.Q6J("ngModel",t.profile.post_code),e.xp6(5),e.Q6J("ngModel",t.profile.city),e.xp6(5),e.s9C("label",t.loading?"Loading ...":"Update"),e.Q6J("disabled",t.loading)}}let se=(()=>{class o{constructor(t,i,n,a,s){this.messageService=t,this.storageService=i,this.profileQuery=n,this.profileService=a,this.authentificationQuery=s,this.loading=!0,this.loggedInUserId=null,this.uploading=!1}ngOnInit(){this.getLoggedInUserId$(),this.getSelectedProfile(),this.loggedInUserId&&(this.profileRealTimeSubscription=this.profileService.getRealTimeChanges(this.loggedInUserId))}getLoggedInUserId$(){this.userIdSubscription=this.authentificationQuery.uuid$.subscribe(t=>{t&&(this.loggedInUserId=t)})}getSelectedProfile(){this.loggedInUserId&&(this.profileSubscription=this.profileQuery.selectEntity(this.loggedInUserId).subscribe(t=>{t&&(this.profile=JSON.parse(JSON.stringify({id:t.id,amendment_counter:t.amendment_counter,follower_counter:t.follower_counter,following_counter:t.following_counter,groups_counter:t.groups_counter,name:t.name,website:t.website,avatar_url:t.avatar_url,contact_email:t.contact_email,contact_phone:t.contact_phone,street:t.street,post_code:t.post_code,city:t.city,about:t.about,unread_notifications_counter:t.unread_notifications_counter,fts:t.fts})),this.loading=!1)}))}updateContactInformation(t){var i=this;return(0,c.Z)(function*(){try{i.loading=!0,yield i.profileService.update(i.loggedInUserId,t),i.messageService.add({severity:"success",summary:"Update erfolgreich."})}catch(n){i.messageService.add({severity:"error",summary:n})}finally{i.loading=!1}})()}updateProfilePhoto(t,i){var n=this;return(0,c.Z)(function*(){if(n.profile)try{n.uploading=!0;const a=n.storageService.createFilePath(t);try{const s=yield n.storageService.uploadImg(a,n.profile.avatar_url||void 0,"avatars");n.profile.avatar_url=s,yield n.updateContactInformation({avatar_url:s}),i.clear(),n.messageService.add({severity:"success",summary:"Upload des Avatars war erfolgreich."})}catch(s){n.messageService.add({severity:"error",summary:s})}}catch(a){n.messageService.add({severity:"error",summary:a.message})}finally{n.uploading=!1}})()}ngOnDestroy(){this.profileSubscription&&this.profileSubscription.unsubscribe(),this.profileRealTimeSubscription&&this.profileRealTimeSubscription.unsubscribe(),this.userIdSubscription&&this.userIdSubscription.unsubscribe()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.ez),e.Y36(ne.V),e.Y36(S.w),e.Y36(w.H),e.Y36(h.c))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-edit-profile"]],features:[e._Bn([p.ez,N.eN])],decls:9,vars:4,consts:[["styleClass","max-w-90","position","top-right"],[3,"noTopBar"],["slot","main"],[1,"mb-8"],[1,"mx-4"],["data-cy","backButton",3,"title","link"],["class","mt-4",4,"ngIf"],["slot","side"],[1,"mt-4"],[4,"ngIf"],[1,"grid"],[1,"col-12","md:col-6"],[1,"p-float-label"],["type","text","pInputText","","name","name","data-cy","name",1,"w-full",3,"ngModel","ngModelChange"],["for","float-input"],["type","url","pInputText","","name","website","data-cy","website",1,"w-full",3,"ngModel","ngModelChange"],[1,"col-12"],["pInputTextarea","","name","about","data-cy","about",1,"w-full",3,"autoResize","ngModel","ngModelChange"],["about",""],[3,"image",4,"ngIf"],["name","myfile[]","accept","image/*","data-cy","imageUpload",1,"full-w",3,"auto","customUpload","uploadHandler"],["fileUploader",""],["type","email","pInputText","","name","contact_email","data-cy","contactEmail",1,"w-full",3,"ngModel","ngModelChange"],["type","text","pInputText","","name","contact_phone","data-cy","contactPhone",1,"w-full",3,"ngModel","ngModelChange"],["type","text","pInputText","","name","street","data-cy","street",1,"w-full",3,"ngModel","ngModelChange"],["type","text","pInputText","","name","post_code","data-cy","postCode",1,"w-full",3,"ngModel","ngModelChange"],["type","text","pInputText","","name","city","data-cy","city",1,"w-full",3,"ngModel","ngModelChange"],[1,"flex","flex-column"],[1,"flex","align-items-center","justify-content-center"],["pButton","","type","button","data-cy","updateProfileInformationButton",3,"label","disabled","click"],[3,"image"]],template:function(t,i){1&t&&(e.TgZ(0,"p-toast",0),e._uU(1,">"),e.qZA(),e.TgZ(2,"app-wrapper-grid",1)(3,"div",2)(4,"div",3)(5,"div",4),e._UZ(6,"app-back-button",5),e.YNc(7,le,61,15,"div",6),e.qZA()()(),e._UZ(8,"div",7),e.qZA()),2&t&&(e.xp6(2),e.Q6J("noTopBar",!0),e.xp6(4),e.Q6J("title","Zur\xfcck")("link","/profile/edit"),e.xp6(1),e.Q6J("ngIf",i.profile))},dependencies:[u.O5,_.o,b.Hq,m.Fj,m.JJ,m.On,A.g,T.p,y.q,d.FN,v.V,M.W],styles:["a[_ngcontent-%COMP%]{text-decoration:none;color:#000}"]}),o})();function R(o){return[{label:"\xdcBERSICHT",routerLink:[`/profile/${o}`],routerLinkActiveOptions:{exact:!0},id:"overview-cy-external"}]}function G(o){return[{icon:"pi pi-fw pi-home",routerLink:[`/profile/${o}`],routerLinkActiveOptions:{exact:!0},id:"overview-cy-external-mob"}]}var ce=r(4593),B=r(4479),L=r(4524),pe=r(6355),de=r(3078),ue=r(8644);function ge(o,l){1&o&&(e.TgZ(0,"div",14),e._uU(1,"Logout"),e.qZA())}let me=(()=>{class o{constructor(t,i,n){this.authentificationService=t,this.authentificationQuery=i,this.router=n,this.menuItemsSpecial=[],this.menuItemsStandart=[],this.menuItemsMegaSpecial=[],this.menuItemsMegaStandart=[],this.loggedInUserId="",this.isOwner=!0}ngOnInit(){this.loggedInUserSubscription=this.authentificationQuery.uuid$.subscribe(t=>{t&&(this.loggedInUserId=t,this.menuItemsSpecial=[{label:"\xdcBERSICHT",routerLink:["/profile"],routerLinkActiveOptions:{exact:!0},id:"overview-cy"},{label:"\xc4NDERN",routerLink:["/profile/edit"],routerLinkActiveOptions:{exact:!0},id:"edit-cy"}],this.menuItemsStandart=R(this.loggedInUserId),this.menuItemsMegaSpecial=[{icon:"pi pi-fw pi-home",routerLink:["/profile"],routerLinkActiveOptions:{exact:!0},id:"overview-cy-mob"},{icon:"pi pi-fw pi-user-edit",routerLink:["/profile/edit"],routerLinkActiveOptions:{exact:!0},id:"edit-cy-mob"}],this.menuItemsMegaStandart=G(this.loggedInUserId))})}ngOnDestroy(){this.loggedInUserSubscription&&this.loggedInUserSubscription.unsubscribe()}signOut(){var t=this;return(0,c.Z)(function*(){yield t.authentificationService.signOut(),t.router.navigate(["/login"])})()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(ce.g),e.Y36(h.c),e.Y36(g.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-edit"]],decls:17,vars:14,consts:[[3,"megaMenuItemSpecial","megaMenuItemStandart","specialOrStandart"],["slot","main"],[1,"mb-8"],[1,"mx-4"],[3,"headline"],["data-cy","profile-edit",3,"title","link"],["data-cy","follower-edit",3,"title","link"],["data-cy","groups-edit",3,"title","link"],[1,"text-center","on-dark-surface-in-dark-theme"],[1,"cursor-pointer",3,"click"],["severity","custom","data-cy","logout"],["pTemplate",""],["slot","side"],[3,"menuItemsSpecial","menuItemsStandart","specialOrStandart"],[1,"ml-2"]],template:function(t,i){1&t&&(e._UZ(0,"app-menu-bar-secondary-top",0),e.TgZ(1,"app-wrapper-grid")(2,"div",1)(3,"div",2)(4,"div",3),e._UZ(5,"app-headline-of-list",4)(6,"app-list-element",5)(7,"app-list-element",6)(8,"app-list-element",7),e.TgZ(9,"div",8),e._UZ(10,"app-switch-theme"),e.qZA(),e._UZ(11,"app-headline-of-list",4),e.TgZ(12,"a",9),e.NdJ("click",function(){return i.signOut()}),e.TgZ(13,"p-messages",10),e.YNc(14,ge,2,0,"ng-template",11),e.qZA()()()()(),e.TgZ(15,"div",12),e._UZ(16,"app-menu-bar-secondary-right",13),e.qZA()()),2&t&&(e.Q6J("megaMenuItemSpecial",i.menuItemsMegaSpecial)("megaMenuItemStandart",i.menuItemsMegaStandart)("specialOrStandart",i.isOwner),e.xp6(5),e.Q6J("headline","INHALTE"),e.xp6(1),e.Q6J("title","Profil")("link","/profile/edit/profile"),e.xp6(1),e.Q6J("title","Follower-Management")("link","/profile/edit/follower"),e.xp6(1),e.Q6J("title","Gruppen-Management")("link","/profile/edit/groups"),e.xp6(3),e.Q6J("headline","INHALTE"),e.xp6(5),e.Q6J("menuItemsSpecial",i.menuItemsSpecial)("menuItemsStandart",i.menuItemsStandart)("specialOrStandart",i.isOwner))},dependencies:[p.jx,U.V,v.V,B.e,L.U,pe.g,de.d,ue.o],styles:["a[_ngcontent-%COMP%]{text-decoration:none;color:#000}"]}),o})();var fe=r(2606),he=r(1061),ve=r(1669);const Ie=function(o,l){return{title:o,subtitle:"TODO",imgUrl:l}};function be(o,l){if(1&o&&e._UZ(0,"app-wiki-header",15),2&o){const t=e.oxw(2);e.Q6J("wikiHeader",e.WLB(1,Ie,t.profile.name,t.profile.avatar_url))}}function ye(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"div",16)(1,"button",17),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.followOrUnfollowProfile())}),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.s9C("label",t.profileUI.isFollowing?"Unfollow":"Follow"),e.Q6J("disabled",t.loading)}}const Se=function(o){return{name:"Antr\xe4ge",number:o}},we=function(o){return{name:"Follower",number:o}},_e=function(o){return{name:"Following",number:o}},Te=function(o){return{name:"Gruppen",number:o}},Fe=function(o,l,t,i){return[o,l,t,i]};function Me(o,l){if(1&o&&e._UZ(0,"app-key-figures",18),2&o){const t=e.oxw(2);e.Q6J("keyFigureList",e.l5B(9,Fe,e.VKq(1,Se,t.profile.amendment_counter),e.VKq(3,we,t.profile.follower_counter),e.VKq(5,_e,t.profile.following_counter),e.VKq(7,Te,t.profile.groups_counter)))}}const xe=function(o,l,t,i,n,a){return{about:o,contact_email:l,contact_phone:t,street:i,post_code:n,city:a}};function Ce(o,l){if(1&o&&e._UZ(0,"app-about-and-contact",19),2&o){const t=e.oxw(2);e.Q6J("contactData",e.HTZ(1,xe,t.profile.about,t.profile.contact_email,t.profile.contact_phone,t.profile.street,t.profile.post_code,t.profile.city))}}function Ze(o,l){if(1&o&&(e.TgZ(0,"div",8)(1,"h1"),e._uU(2,"V1 App"),e.qZA(),e.YNc(3,be,1,4,"app-wiki-header",9),e.TgZ(4,"div",10),e.YNc(5,ye,2,2,"div",11),e.qZA(),e.YNc(6,Me,1,14,"app-key-figures",12),e.TgZ(7,"div",13),e.YNc(8,Ce,1,8,"app-about-and-contact",14),e.qZA(),e._UZ(9,"div"),e.qZA()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",t.profile),e.xp6(2),e.Q6J("ngIf",!t.profileUI.isOwner),e.xp6(1),e.Q6J("ngIf",t.profile),e.xp6(2),e.Q6J("ngIf",t.profile)}}let H=(()=>{class o{constructor(t,i,n,a,s,I){this.authentificationQuery=t,this.route=i,this.followingservice=n,this.messageService=a,this.profileService=s,this.profileQuery=I,this.menuItemsSpecial=[],this.menuItemsStandart=[],this.menuItemsMegaSpecial=[],this.menuItemsMegaStandart=[],this.selectedProfileId=null,this.loggedInUserId=null,this.loading=!1,this.error=!1}ngOnInit(){this.getLoggedInUserId$(),this.getSelectedId(),this.selectedProfileId&&(this.profileService.checkIfIsOwner(this.selectedProfileId),this.profileUISubscription=this.profileQuery.selectUI$(this.selectedProfileId).subscribe(t=>{t&&(this.profileUI=t)}),this.checkIfAlreadyFollower(),this.loadInitialData(),this.menuItemsSpecial=[{label:"\xdcBERSICHT",routerLink:["/profile"],routerLinkActiveOptions:{exact:!0},id:"overview-cy"},{label:"\xc4NDERN",routerLink:["/profile/edit"],routerLinkActiveOptions:{exact:!0},id:"edit-cy"}],this.menuItemsStandart=R(this.selectedProfileId),this.menuItemsMegaSpecial=[{icon:"pi pi-fw pi-home",routerLink:["/profile"],routerLinkActiveOptions:{exact:!0},id:"overview-cy-mob"},{icon:"pi pi-fw pi-user-edit",routerLink:["/profile/edit"],routerLinkActiveOptions:{exact:!0},id:"edit-cy-mob"}],this.menuItemsMegaStandart=G(this.selectedProfileId))}getLoggedInUserId$(){this.userSubscription=this.authentificationQuery.uuid$.subscribe(t=>{t&&(this.loggedInUserId=t)})}loadInitialData(){var t=this;return(0,c.Z)(function*(){if(console.log("called"),t.error=!1,t.loading=!0,console.log(t.error),console.log(t.loading),t.selectedProfileId)try{yield t.profileService.upsert(t.selectedProfileId),t.profileSubscription=t.profileQuery.selectEntity(t.selectedProfileId).subscribe(i=>{i&&(console.log("loaded profile data from store again"),console.log(i),t.profile=i)}),t.profileRealtimeChangesSubscription=t.profileService.getRealTimeChanges(t.selectedProfileId),t.followerRealTimeChangesSubscription=t.profileService.getRealTimeChangesIfStillFollower(t.selectedProfileId)}catch(i){t.messageService.add({severity:"error",summary:i.message}),t.error=!0,t.errorMessage=i.message}finally{t.loading=!1}})()}getSelectedId(){this.route.paramMap.subscribe(t=>{let i=String(t.get("id"));this.selectedProfileId="null"===i?this.loggedInUserId:i})}followOrUnfollowProfile(){var t=this;return(0,c.Z)(function*(){if(t.selectedProfileId)if(t.profileUI.isFollowing)try{t.loading=!0,yield t.followingservice.unfollowTransaction(t.selectedProfileId),t.selectedProfileId&&(t.profileService.updateIsFollowing(t.selectedProfileId,!1),t.messageService.add({severity:"success",summary:"Eine Ideenquelle weniger."}))}catch(i){t.messageService.add({severity:"error",summary:i})}finally{t.loading=!1}else try{t.loading=!0,yield t.followingservice.followTransaction(t.selectedProfileId),t.selectedProfileId&&(t.profileService.updateIsFollowing(t.selectedProfileId,!0),t.messageService.add({severity:"success",summary:"Du folgst einer neuen Inspirationsquelle."}))}catch(i){t.messageService.add({severity:"error",summary:i})}finally{t.loading=!1}})()}checkIfAlreadyFollower(){this.selectedProfileId&&this.followingservice.isAlreadyFollower(this.selectedProfileId).then(t=>{void 0!==t.data[0]?(console.log("following"),this.selectedProfileId&&this.profileService.updateIsFollowing(this.selectedProfileId,!0)):this.selectedProfileId&&this.profileService.updateIsFollowing(this.selectedProfileId,!1)}).catch()}ngOnDestroy(){this.profileSubscription&&this.profileSubscription.unsubscribe(),this.profileRealtimeChangesSubscription&&this.profileRealtimeChangesSubscription.unsubscribe(),this.followerRealTimeChangesSubscription&&this.followerRealTimeChangesSubscription.unsubscribe(),this.userSubscription&&this.userSubscription.unsubscribe(),this.profileUISubscription&&this.profileUISubscription.unsubscribe()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(h.c),e.Y36(g.gz),e.Y36(D.J),e.Y36(p.ez),e.Y36(w.H),e.Y36(S.w))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-profile"]],features:[e._Bn([p.ez])],decls:9,vars:11,consts:[["styleClass","max-w-90","position","top-right"],[3,"megaMenuItemSpecial","megaMenuItemStandart","specialOrStandart"],[3,"noTopBar"],["slot","main"],[3,"error","loading","errorMessage","retryAction"],["class","mb-8",4,"ngIf"],["slot","side"],[3,"menuItemsSpecial","menuItemsStandart","specialOrStandart"],[1,"mb-8"],[3,"wikiHeader",4,"ngIf"],[1,"flex","flex-column"],["class","flex align-items-center justify-content-center",4,"ngIf"],[3,"keyFigureList",4,"ngIf"],[1,"mb-30"],[3,"contactData",4,"ngIf"],[3,"wikiHeader"],[1,"flex","align-items-center","justify-content-center"],["pButton","","type","button","data-cy","followButton",3,"label","disabled","click"],[3,"keyFigureList"],[3,"contactData"]],template:function(t,i){1&t&&(e.TgZ(0,"p-toast",0),e._uU(1,">"),e.qZA(),e._UZ(2,"app-menu-bar-secondary-top",1),e.TgZ(3,"app-wrapper-grid",2)(4,"div",3)(5,"app-loading-spinner",4),e.NdJ("retryAction",function(){return i.loadInitialData()}),e.qZA(),e.YNc(6,Ze,10,4,"div",5),e.qZA(),e.TgZ(7,"div",6),e._UZ(8,"app-menu-bar-secondary-right",7),e.qZA()()),2&t&&(e.xp6(2),e.Q6J("megaMenuItemSpecial",i.menuItemsMegaSpecial)("megaMenuItemStandart",i.menuItemsMegaStandart)("specialOrStandart",i.profileUI.isOwner||!1),e.xp6(1),e.Q6J("noTopBar",!1),e.xp6(2),e.Q6J("error",i.error)("loading",i.loading)("errorMessage",i.errorMessage),e.xp6(1),e.Q6J("ngIf",!i.loading&&!i.error),e.xp6(2),e.Q6J("menuItemsSpecial",i.menuItemsSpecial)("menuItemsStandart",i.menuItemsStandart)("specialOrStandart",i.profileUI.isOwner))},dependencies:[u.O5,b.Hq,d.FN,v.V,B.e,L.U,fe.F,he.T,ve.Z,x.g]}),o})();const Ue=[{path:"",component:H,canActivate:[f.u]},{path:"edit",component:me,canActivate:[f.u]},{path:"edit/profile",component:se,canActivate:[f.u]},{path:"edit/follower",component:q,canActivate:[f.u]},{path:"edit/groups",component:oe,canActivate:[f.u]},{path:":id",component:H,canActivate:[f.u]}];let Pe=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[g.Bz.forChild(Ue),g.Bz]}),o})();var Ae=r(5604),Je=r(3943),Oe=r(2942),De=r(4384),Qe=r(5021),Ne=r(2263),Ee=r(4303),Ye=r(4747);let Re=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[u.ez,Z.LU,U.$,P.O,g.Bz,_.j,k.L$,b.hJ,m.u5,A.A,T.O,y.F,d.EV,V,Pe,N.JF,F.x,Ae.Q,Je.q,d.EV,F.x,J.n,y.F,T.O,Oe.N,Ye.y,P.O,De.I,Qe.C,Ne.q,Ee.B,O.z]}),o})()}}]);